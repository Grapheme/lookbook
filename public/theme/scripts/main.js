window.LookBook={},window.Help={},window.jQuery.fn.autosize=function(){return autosize(this)},Help.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},Help.getRandomArbitrary=function(t,e){return Math.random()*(e-t)+t},Help.avaGenerator=function(){var t=$("[data-empty-name]");t.length&&t.each(function(){var t=$(this).attr("data-empty-name"),e=t.split(" "),o="";$.each(e,function(t,e){o+=e.charAt(0)}),$(this).find(".js-empty-chars").html(o)})},Help.typicalSubmit=function(){$(document).on("submit",".js-ajax-form",function(t){var e=$(this);return Help.ajaxSubmit(e),t.preventDefault(),!1})},Help.ajaxSubmit=function(t,e){var o=$(t).find(".js-response-text"),a={beforeSubmit:function(){o.hide(),$(t).find('[type="submit"]').addClass("loading").attr("disabled","disabled")},success:function(a){a.status&&a.redirect&&""!=a.redirect&&(window.location.href=a.redirect),$(t).find('[type="submit"]').removeClass("loading").removeAttr("disabled"),e&&e.success&&e.success(a),$(t).hasClass("js-reg-form")?($(".js-full-reg").slideUp(),$(".js-final-text").html(a.responseText)):a.responseText&&o.show().html(a.responseText)},error:function(){o.show().text("Ошибка на сервере, попробуйте позже"),$(t).find('[type="submit"]').removeClass("loading").removeAttr("disabled")}};$(t).ajaxSubmit(a)},Help.avaCrop=function(t){{var e=$(t).attr("data-minWidth"),o=$(t).attr("data-minHeight"),a=$(t).attr("data-ratio");$('.js-ava-overlay[data-type="'+$(t).attr("data-type")+'"] .js-crop-ava > img')}$(".js-crop-ava > img").cropper({aspectRatio:a,minCropBoxWidth:e,minCropBoxHeight:o,preview:$(".js-crop-preview"),crop:function(){}})},Help.uploadPhoto=function(t){var e=t.parents("form"),o=e.attr("data-type");file=t[0].files[0],fr=new FileReader,e.find(".js-ava-error-cont").html("").hide(),fr.onload=function(a){$(".js-image-test").remove();var s='<img src="'+a.target.result+'">',i='<img class="js-image-test" style="position: fixed; left: -9999px;" src="'+a.target.result+'">';$("html").append(i);$(".js-image-test").width(),$(".js-image-test").height();$(".js-crop-ava").html(s),$('.js-ava-overlay[data-type="'+o+'"]').show(),Help.avaCrop(e),t.val("")},fr.readAsDataURL(file)},Help.avaSubmit=function(t,e){var o=$(t).find(".js-ava-error-server"),a={beforeSubmit:function(){o.hide(),o.text("Загрузка...")},success:function(t){t.responseText&&o.show().text(t.responseText),e(t)},error:function(){o.show().text("Ошибка на сервере, попробуйте позже")}};$(t).ajaxSubmit(a)},jQuery.extend(jQuery.validator.messages,{required:"Это поле необходимо заполнить.",remote:"Пожалуйста, введите правильное значение.",email:"Пожалуйста, введите корретный адрес электронной почты.",url:"Пожалуйста, введите корректный URL.",date:"Пожалуйста, введите корректную дату.",dateISO:"Пожалуйста, введите корректную дату в формате ISO.",number:"Пожалуйста, введите число.",digits:"Пожалуйста, вводите только цифры.",creditcard:"Пожалуйста, введите правильный номер кредитной карты.",equalTo:"Пароли не совпадают",accept:"Пожалуйста, выберите файл с правильным расширением.",maxlength:jQuery.validator.format("Пожалуйста, введите не больше {0} символов."),minlength:jQuery.validator.format("Пожалуйста, введите не меньше {0} символов."),rangelength:jQuery.validator.format("Пожалуйста, введите значение длиной от {0} до {1} символов."),range:jQuery.validator.format("Пожалуйста, введите число от {0} до {1}."),max:jQuery.validator.format("Пожалуйста, введите число, меньшее или равное {0}."),min:jQuery.validator.format("Пожалуйста, введите число, большее или равное {0}."),extension:jQuery.validator.format("Вы можете загрузить изображение только со следующими расширениями: jpeg, jpg, png, gif.")}),LookBook.SimpleSlide=function(){$(".js-slide-item").length&&$(".js-slide-link").on("click",function(){return $(this).parents(".js-slide-parent").find(".js-slide-item").slideDown(),$(this).parent().slideUp(),!1})},LookBook.UiButton=function(){if($(".js-set-check").length){var t=$(".js-set-check"),e=0,o="ui-check-";t.each(function(){var t=o+e;$(this).find('[type="checkbox"]').attr("id",t),$(this).find("label").attr("for",t),e++})}},LookBook.Search=function(){$(".js-open-search").on("click",function(){$('.js-search-form input[type="text"]').trigger("focus"),$(".js-search").addClass("active")}),$(".js-close-search").on("click",function(){$(".js-search").removeClass("active")}),$(".js-search-form").on("submit",function(){var t=$(this).find('input[type="text"]');return""==t.val()?(t.trigger("focus"),!1):void 0})},LookBook.Gallery=function(){if($(".js-gallery").length){var t=$(".js-gallery"),e=$(".js-gallery-full"),o={nav:"thumbs",arrows:"always",click:!1,loop:!0,width:"100%",height:"100%",minHeight:"300px",maxHeight:"500px",fit:"contain"},a={nav:!1,arrows:"always",loop:!0,width:"100%",height:"100%",fit:"contain"},s=t.fotorama(o),i=s.data("fotorama"),n=e.fotorama(a),r=n.data("fotorama");t.on("click",".fotorama__stage__shaft",function(){$(".js-gallery-overlay").show(),r||(r=n.data("fotorama")),r&&r.show(i.activeIndex)}),$(".js-gallery-close").on("click",function(){return $(".js-gallery-overlay").fadeOut("fast"),!1}),e.on("fotorama:show",function(t,e){i.show(e.activeIndex)})}},LookBook.ActionButton=function(){$(".js-action-btn").length&&$(".js-action-btn").on("submit",function(t){t.preventDefault();var e=$(this),o=e.find('[type="submit"]'),a={beforeSubmit:function(){o.addClass("loading")},success:function(t){t.responseText&&o.text(t.responseText),o.removeClass("loading").attr("disabled","disabled")},error:function(){o.text("Ошибка на сервере").removeClass("loading")}};return $(e).ajaxSubmit(a),!1})},LookBook.CommentForm=function(){var t=$(".js-comment-form");if(t.length){var e=t.find("textarea");e.on("keydown",function(e){return 13!=e.keyCode||e.shiftKey?void 0:(t.trigger("submit"),!1)}),t.on("submit",function(o){return o.preventDefault(),e.val().trim().length<1?!1:void Help.ajaxSubmit(t,{success:function(t){$(".js-comments").prepend(t.html),e.val("").removeAttr("style"),Help.avaGenerator()}})})}},LookBook.Dashboard=function(){var t=function(t){var e=t.parents(".js-post").first(),o={beforeSubmit:function(){e.addClass("opacity05"),$(t).find('[type="submit"]').attr("disabled","disabled")},success:function(t){t.status&&e.slideUp()},error:function(){e.removeClass("opacity05"),$(t).find('[type="submit"]').removeAttr("disabled")}};t.ajaxSubmit(o)},e=function(t){var e=t.find(".js-response-text"),o=$(".js-posts"),a={beforeSubmit:function(){e.hide(),t.find('[type="submit"]').addClass("loading").attr("disabled","disabled")},success:function(e){o.append(e.html),e.hide_button&&t.hide(),$("#js-input-from").val(e.from),t.find('[type="submit"]').removeClass("loading").removeAttr("disabled"),$(".js-list-slide").not(".done").length&&LookBook.ListSlider()},error:function(){e.show().text("Ошибка на сервере, попробуйте позже"),t.find('[type="submit"]').removeClass("loading").removeAttr("disabled")}};t.ajaxSubmit(a)};$(document).on("submit",".js-delete-post",function(){return t($(this)),!1}),$(document).on("submit",".js-more-posts",function(){return e($(this)),!1})},LookBook.ContactForm=function(){var t=$(".js-contact-form");t.length&&t.validate({rules:{name:{required:!0},email:{required:!0,email:!0},message:{required:!0}},submitHandler:function(t){return Help.ajaxSubmit(t,{success:function(){$(t).slideUp(),$(".js-contact-success").slideDown()}}),!1}})},LookBook.DashForm=function(){var t=$(".js-dashboard-form");if(t.length){var e=$(".js-form-value"),o=function(){var t=$(".js-tag-sample").html();$(".js-tag-sample").remove(),$(".js-add-tag").on("click",function(){return $(".js-add-tag-cont").before('<tr class="tags__item js-tags-item">'+t+"</tr>"),!1}),$(".js-tag-delete")},a=function(t){var e=t.parents(".js-form-value");e.find("input").trigger("focus")},s=function(t){var e=t.parents(".js-form-value");e.addClass("focus-value")},i=function(t){var e=t.parents(".js-form-value");e.removeClass("focus-value"),n()},n=function(){e.each(function(){var t=$(this),e=$(this).find("input");""==e.val()?t.addClass("empty-value"):t.removeClass("empty-value")})},r=function(t){Help.uploadPhoto($(t).find('input[type="file"]'))},l=function(){o(),n(),$(document).on("click",".js-add-value",function(){return a($(this)),!1}),$(".js-ava-overlay-close, .js-ava-overlay .overlay__background").on("click",function(){return $(".js-ava-overlay").hide(),!1}),e.find("input").on("focus",function(){s($(this))}),e.find("input").on("focusout",function(){i($(this))}),$("a").on("focus",function(){$(this).parents(".js-form-value").length&&a($(this))}),$("#dashboard-main").validate({rules:{name:{required:!0},email:{required:!0,email:!0}},errorPlacement:function(t,e){e.parents("tr").addClass("error")},success:function(t,e){$(e).parents("tr").removeClass("error")},submitHandler:function(t){return Help.ajaxSubmit(t),!1}}),$("#dashboard-pass").validate({rules:{password:{required:!0,minlength:6},password_confirmation:{required:!0,equalTo:"#dashboard-pass [name='password']"}},errorPlacement:function(t,e){e.parents("tr").addClass("error")},success:function(t,e){$(e).parents("tr").removeClass("error")},submitHandler:function(t){return Help.ajaxSubmit(t),!1}});var t=[".js-ava-upload-form",".js-ava-change-form"];$.each(t,function(t,e){$(e).find('input[type="file"]').on("change",function(){var t=$(this).parents(e);t.find(".js-ava-error-server").html(""),t.trigger("submit")})}),$(".js-ava-delete").find(".js-submit").on("click",function(){var t=$(this).parents(".js-ava-delete");t.find(".js-ava-error-server").html(""),t.trigger("submit")}),$(".js-ava-change-form").each(function(){$(this).validate({rules:{photo:{required:!0,extension:"jpg|jpeg|png|gif"}},errorElement:"div",errorLabelContainer:".js-ava-error-cont",submitHandler:function(t){return r(t),!1}})}),$(".js-ava-upload-form").each(function(){$(this).validate({rules:{photo:{required:!0,extension:"jpg|jpeg|png|gif"}},errorElement:"div",errorLabelContainer:".js-ava-error-cont",submitHandler:function(t){return r(t),!1}})}),$(".js-ava-delete").each(function(){$(this).validate({rules:{},errorElement:"div",errorLabelContainer:".js-ava-error-cont",submitHandler:function(t){return Help.avaSubmit(t,function(){"background"==$(t).attr("data-type")?($(".js-background").addClass("ava-empty"),$(".js-background-cont").html("")):($(".js-ava-cont").addClass("ava-empty"),$(".js-ava-img-cont").html(""))}),!1}})}),$(".js-ava-crop-upload").on("submit",function(t){t.preventDefault();var e=$(this),o=$(".js-crop-ava > img").cropper("getCroppedCanvas").toDataURL();e.find('input[name="photo"]').val(o),Help.ajaxSubmit(e,{success:function(t){if(console.log($(e).attr("data=type")),"background"!=$(e).attr("data-type"))var o=$(".js-ava-cont"),a=".js-ava-img-cont";else var o=$(".js-background"),a=".js-background-cont";o.each(function(){$(this).removeClass("ava-empty");var e=$(this).find(a),o='<img alt="" src="'+t.image+'">';e.length?e.html(o):($(this).find("img").remove(),$(this).append(o))}),$(".js-ava-overlay").hide()}})})};l()}},LookBook.FitText=function(){$.fn.fitText=function(){for(var t=$(this).parents(".js-fit-parent"),e=$(this);e.width()>t.width();){var o=parseInt(e.css("font-size"))-1+"px";e.css({"font-size":o})}},$(".js-fit-text").fitText()},LookBook.Auth=function(){var t=this,e=$(".js-overlay"),o=e.find(".overlay__background"),a=e.find("[data-popup]"),s=$(".js-close-popup"),i=500;this.show=function(t){var s=a.filter('[data-popup="'+t+'"]');s.length&&(s.siblings().removeClass("active").hide(),e.show(),$("html").addClass("locked"),setTimeout(function(){o.addClass("active"),s.show(),setTimeout(function(){s.addClass("active")},50)},50))},this.close=function(){window.location.hash="",a.removeClass("active"),o.removeClass("active"),$("html").removeClass("locked"),setTimeout(function(){a.hide(),e.hide()},i)},this.hashOpen=function(){var e=window.location.hash.substring(1);""!=e&&t.show(e)},s.on("click",function(){return t.close(),!1}),$(window).on("hashchange",function(){t.hashOpen()}),this.hashOpen(),$("#form-auth").validate({rules:{login:{required:!0,email:!0},password:{required:!0}},submitHandler:function(t){return Help.ajaxSubmit(t),!1}}),$("#form-reg").validate({rules:{email:{required:!0,email:!0},password:{required:!0,minlength:6},password_verify:{required:!0,equalTo:"#form-reg [name='password']"},name:{required:!0}},submitHandler:function(t){return Help.ajaxSubmit(t),!1}}),$("#form-restore_before").validate({rules:{email:{required:!0,email:!0}},submitHandler:function(t){return Help.ajaxSubmit(t),!1}}),$("#form-restore").validate({rules:{password:{required:!0,minlength:6},password_confirmation:{required:!0,equalTo:"#form-restore [name='password']"}},submitHandler:function(t){return Help.ajaxSubmit(t),!1}})},LookBook.TopSplit=function(){if($(".js-top-split").length){var t=$(".js-top-split >li"),e=[],o=6;add_class="",$(".js-top-split").hasClass("js-collage")&&($(".js-collage").removeClass("js-collage"),add_class=" js-collage");for(var a=0;a<t.length/o;a++){var s=$(),i=a*o;for(j=i;j<i+o;j++)t.eq(j).length&&s.push(t.eq(j)[0]);e.push(s)}$.each(e,function(t,e){e.wrapAll('<ul class="posts-slider js-list-slide'+add_class+' clearfix" />')}),$(".js-top-split").css("height",$(".js-top-split .posts-slider").first().outerHeight(!0))}},LookBook.TopCollage=function(){if($(".js-collage").length){if($(".js-collage li").length>3)var t=[{x:[0,60],y:[0,35]},{x:[-35,35],y:[0,35]},{x:[0,-35],y:[0,35]},{x:[0,60],y:[-35,0]},{x:[-35,35],y:[-35,0]},{x:[0,-35],y:[-35,0]}];else var t=[{x:[0,60],y:[-5,5]},{x:[-35,35],y:[-5,5]},{x:[0,-35],y:[-5,5]}];setTimeout(function(){$(".js-collage").addClass("active"),setTimeout(function(){$(".js-collage").addClass("fast-animation")},1e3)},50),$(".js-collage").each(function(){var e=$(this).find("li");$.each(t,function(t,o){var a=Help.getRandomInt(o.x[0],o.x[1]),s=Help.getRandomInt(o.y[0],o.y[1]),i=Help.getRandomArbitrary(.6,.95),n="transform: translate("+a+"%, "+s+"%) scale("+i+"); z-index: 1;",r="transform: translate("+a+"%, "+s+"%) scale(1); z-index: 5;";e.eq(t).attr("style",n).attr("data-static-style",n).attr("data-hover-style",r)})}),$(".js-collage li").on("mouseenter",function(){$(this).attr("style",$(this).attr("data-hover-style"))}).on("mouseleave",function(){$(this).attr("style",$(this).attr("data-static-style"))})}},LookBook.ListSlider=function(){$(".js-list-slider").length&&$(".js-list-slider").each(function(){if(!$(this).hasClass("done")){var t,e,o=$(this),a=o.find(".js-list-slide"),s=o.find(".js-list-dots"),i=["to-left","to-right","out-left","out-right"],n=function(s,n){var r=a.eq(s);e=s,o.find(".js-list-dot").eq(s).addClass("active").siblings().removeClass("active"),a.removeClass(i.join(" ")),r.prev().addClass("to-left").prevAll().addClass("out-left"),r.next().addClass("to-right").nextAll().addClass("out-right"),n&&(clearTimeout(t),l(e))},r=function(){a.on("click",function(){return $(this).hasClass("to-right")||$(this).hasClass("to-left")?(n($(this).index(),!0),!1):void 0}),o.find(".js-list-dot").on("click",function(){return n($(this).index(),!0),!1})},l=function(e){e==a.length&&(e=0),n(e),t=setTimeout(function(){l(e+1)},3e3)},u=function(){a.length>1?(a.each(function(){s.append('<a href="#" class="nav__dot js-list-dot"></a>')}),setTimeout(function(){a.addClass("with-transition")},50)):s.remove(),r(),l(0),o.addClass("done")};u()}})},LookBook.DatePicker=function(){$(".js-datepicker").datepicker()},LookBook.Like=function(){var t=function(t){var e=t.attr("data-action");t.addClass("liked"),$.ajax({url:e,type:"post",data:"id="+t.attr("data-post-id"),dataType:"json"}).done(function(e){e.status&&t.find(".js-like-count").text(e.count)}).fail(function(t){console.log(t)})},e=function(){$(document).on("click",".js-like",function(){return $(this).hasClass("liked")?!1:(t($(this)),!1)})};e()},LookBook.Mask=function(){$("[data-mask]").length&&$("[data-mask]").each(function(){var t={};$(this).attr("data-placeholder")&&(t.placeholder=$(this).attr("data-placeholder")),$(this).mask($(this).attr("data-mask"),t)})},LookBook.Firefox=function(){navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&$(".yashare-auto-init").addClass("firefox-style")},LookBook.Categories=function(){var t=$(".js-cat-select");if(t.length){var e=function(t){$(".js-cat-tags option").each(function(){t==$(this).attr("data-category")?$(this).show():$(this).hide()})};t.on("selectmenuchange",function(){e($(this).val())}),e(t.val()),$(".js-cat-tags").chosen()}},LookBook.init=function(){Help.avaGenerator(),Help.typicalSubmit(),LookBook.Dashboard(),LookBook.DatePicker(),LookBook.TopSplit(),LookBook.ListSlider(),LookBook.TopCollage(),LookBook.DashForm(),LookBook.ContactForm(),LookBook.CommentForm(),LookBook.Gallery(),LookBook.Search(),LookBook.FitText(),LookBook.Auth(),LookBook.ActionButton(),LookBook.UiButton(),LookBook.SimpleSlide(),LookBook.Mask(),LookBook.Like(),LookBook.Firefox(),LookBook.Categories(),$(".js-autosize").autosize(),$(".js-styled-select").selectmenu(),$(".js-styled-check").button()},$(LookBook.init);